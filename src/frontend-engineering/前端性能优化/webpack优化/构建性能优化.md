# 构建性能优化


## 构建速度优化
2. 使用 webpack5 持久化缓存，能明显提高构件速度
3. 使用lazyCompilation 可以懒编译，能明显提高开发构建速度
4. 约束loader的`include`和`exclude`
5. 使用`module.noParse` 可以跳过对某些文件的编译，因为有些三方库是已经编译过的
6. 新版本组件 eslint-webpack-plugin 替代旧版 eslint-loader， 旧版出现错误会中断编译。
7. 优化`source-map`的配置，使用`eval-cheap-source-map`可以提高构建速度
8. 借助`swc`, `esbuild`等高性能编译器，优化构建速度, 例如terser插件可以指定使用`swc`或`esbuild`对代码进行压缩
9. 采用并行压缩，例如：`thread-loader`、`terser`插件自带的`parallel`参数



## 构建体积优化
1. 尽量使用export {} 导出代码
使用这样的写法，webpack才能做tree-shaking
```js
export {
  xxx
}
```
2. 不要使用babel将esm转为cjs
若代码是`commonjs`代码，将失去tree-shaking优化，需要设置`baberc`配置中的`modules: false`

3. lib库酌情使用 sideEffects

通过设置`package.json`中的`sideEffects`字段，可以告诉webpack哪些是纯的（无副作用）

4. 使用 unplugin-vue-components 或 babel-plugin-import 按需引入组件

5. 可以使用 /*#__PURE__ */ 标记哪些函数没有副作用，进而tree-shaking

6. 合理配置`split-chunk-plugin`，例如其中的`maxInitialRequests`和`maxAsyncRequests`属性，用于控制异步模块和入口模块的拆分粒度。能有效减少重复打包的模块。

7. 三方模块，尽量提取为CDN, 可以增加访问速度，突破HTTP 1.x 的请求并发限制。

8. 使用http2，多路复用等特性，提高了访问速度