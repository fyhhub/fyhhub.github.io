import{_ as t}from"./plugin-vueexport-helper.2444895f.js";import{o,c as l,a as n,b as s,e as p,d as e,r as c}from"./app.d8606833.js";const i={},u=n("h1",{id:"\u5E26\u4F60\u73A9\u8F6C-babel-\u5DE5\u5177\u94FE-\u516D-\u662F\u65F6\u5019\u6765\u770B\u770B-preset-env-\u7684\u6E90\u7801\u4E86",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5E26\u4F60\u73A9\u8F6C-babel-\u5DE5\u5177\u94FE-\u516D-\u662F\u65F6\u5019\u6765\u770B\u770B-preset-env-\u7684\u6E90\u7801\u4E86","aria-hidden":"true"},"#"),s(" \u5E26\u4F60\u73A9\u8F6C babel \u5DE5\u5177\u94FE\uFF08\u516D\uFF09\u662F\u65F6\u5019\u6765\u770B\u770B preset-env \u7684\u6E90\u7801\u4E86")],-1),r=n("h2",{id:"\u4E00\u3001\u524D\u8A00",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4E00\u3001\u524D\u8A00","aria-hidden":"true"},"#"),s(" \u4E00\u3001\u524D\u8A00")],-1),d=n("p",null,[s("\u672C\u6587\u5C06\u5E26\u4F60\u5B66\u4E60"),n("code",null,"preset-env"),s("\u6E90\u7801\uFF0C\u5F7B\u5E95\u7406\u89E3\u8FD9\u4E9B\u914D\u7F6E\u540E\u7684\u542B\u4E49\u3002")],-1),k=n("p",null,"\u5F80\u671F\u56DE\u987E\uFF1A",-1),v={href:"https://juejin.cn/post/7112733626589577230",target:"_blank",rel:"noopener noreferrer"},m={href:"https://juejin.cn/post/7113800415057018894",target:"_blank",rel:"noopener noreferrer"},b={href:"https://juejin.cn/post/7113841261399769102",target:"_blank",rel:"noopener noreferrer"},g={href:"https://juejin.cn/post/7114175523160326175",target:"_blank",rel:"noopener noreferrer"},f={href:"https://juejin.cn/post/7114486435487023112",target:"_blank",rel:"noopener noreferrer"},y=e(`<h2 id="\u4E8C\u3001\u57FA\u672C\u914D\u7F6E" tabindex="-1"><a class="header-anchor" href="#\u4E8C\u3001\u57FA\u672C\u914D\u7F6E" aria-hidden="true">#</a> \u4E8C\u3001\u57FA\u672C\u914D\u7F6E</h2><p>\u5728<code>preset-env</code>\u7684\u914D\u7F6E\u4E2D\uFF0C\u6DFB\u52A0\u4E86<code>core-js</code>\u7684 polyfill \u7684\u652F\u6301\u3002<code>useBuiltIns</code>\u6307\u5B9A\u6309\u9700\u52A0\u8F7D\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>npm i @babel<span class="token operator">/</span>preset<span class="token operator">-</span>env core<span class="token operator">-</span>js@<span class="token number">3</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7B80\u5355\u4F7F\u7528\u4E00\u4E0B\uFF0C\u6211\u4EEC\u5199\u4E86\u4E00\u6BB5<code>includes</code>\u7684 api,\u770B\u770B\u6253\u5305\u540E\u7684\u4EE3\u7801\u662F\u5982\u4F55<code>polyfill</code>\u7684</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>@babel/preset-env</code>\u5E2E\u6211\u4EEC\u5728\u9876\u90E8\u6DFB\u52A0\u4E86\u4E00\u6BB5\u5BFC\u5165\u4EE3\u7801\u3002\u5B9E\u73B0\u4E86<code>includes</code>\u7684 api</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/02316b2cced74978819cf4e8bc3a3a42~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u4EE5\u4E0A\u5C31\u662F\u4E00\u4E2A\u7B80\u5355\u7684\u4F8B\u5B50\uFF0C\u4E0B\u9762\u4ECB\u7ECD\u4E0B\u53C2\u6570\u8BE6\u7EC6\u7684\u4F5C\u7528</p><h2 id="\u4E09\u3001\u901A\u8FC7\u53C2\u6570\u5206\u6790\u6E90\u7801\u8FC7\u7A0B" tabindex="-1"><a class="header-anchor" href="#\u4E09\u3001\u901A\u8FC7\u53C2\u6570\u5206\u6790\u6E90\u7801\u8FC7\u7A0B" aria-hidden="true">#</a> \u4E09\u3001\u901A\u8FC7\u53C2\u6570\u5206\u6790\u6E90\u7801\u8FC7\u7A0B</h2><p>\u6211\u4EEC\u4EE5\u4E0A\u9762\u7684\u4EE3\u7801\u4E3A\u4F8B</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;xxx&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><strong>\u6CE8\u610F\uFF1A\u5728\u4E0B\u9762\u7684\u4F8B\u5B50\u4E2D\uFF0C\u5C06\u7EDF\u4E00\u4F7F\u7528<code>corejs@3</code></strong></p><p>\u4E0B\u9762\u6211\u5C06\u4E00\u4E00\u6F14\u793A<code>preset-env</code>\u7684\u53C2\u6570\u5E2E\u52A9\u7406\u89E3\uFF0C\u5E76\u4E14\u5BF9\u5927\u5BB6\u4EE5\u540E\u7684\u9879\u76EE\u914D\u7F6E\u4E5F\u6709\u4E00\u5B9A\u7684\u5E2E\u52A9\u3002\u5927\u5BB6\u8010\u5FC3\u770B\u5B8C~</p><p>\u5927\u5BB6\u5148\u6253\u5F00\u6E90\u7801\u4F4D\u7F6E: <code>node_modules/@babel/preset-env/lib/index.js</code></p><h3 id="\u53C2\u6570-1-forcealltransforms" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570-1-forcealltransforms" aria-hidden="true">#</a> \u53C2\u6570 1\uFF1AforceAllTransforms</h3><p><strong>\u6E90\u7801</strong>\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _semver<span class="token punctuation">.</span>lt<span class="token punctuation">)</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>version<span class="token punctuation">,</span> <span class="token string">&quot;7.13.0&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span>
  opts<span class="token punctuation">.</span>targets <span class="token operator">||</span>
  opts<span class="token punctuation">.</span>configPath <span class="token operator">||</span>
  opts<span class="token punctuation">.</span>browserslistEnv <span class="token operator">||</span>
  opts<span class="token punctuation">.</span>ignoreBrowserslistConfig
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">var</span> hasUglifyTarget <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>optionsTargets <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> optionsTargets<span class="token punctuation">.</span>uglify<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      hasUglifyTarget <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token keyword">delete</span> optionsTargets<span class="token punctuation">.</span>uglify<span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">
The uglify target has been deprecated. Set the top level
option \\\`forceAllTransforms: true\\\` instead.
</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  targets <span class="token operator">=</span> <span class="token function">getLocalTargets</span><span class="token punctuation">(</span>
    optionsTargets<span class="token punctuation">,</span>
    ignoreBrowserslistConfig<span class="token punctuation">,</span>
    configPath<span class="token punctuation">,</span>
    browserslistEnv
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// \u9700\u8981\u8F6C\u6362\u7684\u76EE\u6807\u73AF\u5883 \u5982\u679C\u4E3Atrue \u5C31\u5168\u90E8\u8F6C\u6362</span>
<span class="token keyword">const</span> transformTargets <span class="token operator">=</span> forceAllTransforms <span class="token operator">||</span> hasUglifyTarget <span class="token operator">?</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token operator">:</span> targets<span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728<code>preset-env</code>\u4E2D\uFF0C\u5728\u4E00\u5F00\u59CB\u4F1A\u8C03\u7528<code>getLocalTargets</code>\u83B7\u53D6\u5F53\u524D\u4F60\u914D\u7F6E\u7684<code>targets</code>\u3002</p><p>\u4F8B\u5982\u6211\u914D\u7F6E:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token string-property property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;last 2 versions&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7ECF\u8FC7<code>getLocalTargets</code>\u5904\u7406\u540E\uFF0C<code>targets</code>\u5982\u4E0B</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/817d67ef7236417d800292f31dc81071~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u5B83\u4F1A\u5217\u51FA\uFF0C\u6D4F\u89C8\u5668\u6240\u80FD\u652F\u6301\u7684\u6700\u4F4E\u7248\u672C\u3002</p><p>\u5F53\u4F60\u5728<code>preset-env</code>\u4E2D\u914D\u7F6E\u4E0A<code>forceAllTransforms: true</code>\uFF0C\u90A3\u4E48\u4EE3\u8868\u6240\u6709\u7684\u4EE3\u7801\u90FD\u9700\u8981<code>polyfill</code></p><p>\u6211\u4EEC\u8DDF\u7740\u6E90\u7801\u7EE7\u7EED\u5F80\u4E0B\u770B~</p><h3 id="\u53C2\u6570-2-include\u3001exclude" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570-2-include\u3001exclude" aria-hidden="true">#</a> \u53C2\u6570 2\uFF1Ainclude\u3001exclude</h3><p><strong>\u6E90\u7801</strong>\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 1. \u6307\u5B9A\u5305\u542B\u7684\u63D2\u4EF6\uFF0C\u6BD4\u5982\u914D\u7F6Etargets\u4E4B\u540E\uFF0C\u6709\u4E9B\u63D2\u4EF6\u88AB\u6392\u9664\u4E86\uFF0C\u4F46\u662F\u6211\u5C31\u662F\u60F3\u7528\u8FD9\u4E2A\u63D2\u4EF6</span>
<span class="token comment">// 2. \u6307\u5B9A\u8981\u5305\u542B\u7684corejs polyfill\u8BED\u6CD5\uFF0C\u4F8B\u5982es.map, es.set\u7B49</span>
<span class="token keyword">const</span> include <span class="token operator">=</span> <span class="token function">transformIncludesAndExcludes</span><span class="token punctuation">(</span>optionsInclude<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 1. \u6307\u5B9A\u6392\u9664\u7684\u63D2\u4EF6\uFF0C\u6BD4\u5982\u914D\u7F6Etargets\u4E4B\u540E\uFF0C\u6709\u4E9B\u63D2\u4EF6\u88AB\u5305\u542B\u4E86\uFF0C\u4F46\u662F\u6211\u60F3\u6392\u9664\u5B83</span>
<span class="token comment">// 2. \u6307\u5B9A\u8981\u6392\u9664\u7684corejs polyfill\u8BED\u6CD5\uFF0C\u4F8B\u5982es.map, es.set\u7B49</span>
<span class="token keyword">const</span> exclude <span class="token operator">=</span> <span class="token function">transformIncludesAndExcludes</span><span class="token punctuation">(</span>optionsExclude<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>include</code>\u548C<code>exclude</code>\u662F\u76F8\u5BF9\u7ACB\u7684\uFF0C\u652F\u6301\u914D\u7F6E\u4E24\u79CD\u6A21\u5F0F</p><ul><li>\u63D2\u4EF6\u540D\u79F0\uFF0C\u4F8B\u5982<code>@babel/plugin-transform-xxx</code></li><li>polyfill \u540D, \u4F8B\u5982<code>es.array.includes</code></li></ul><p><strong>\u4EC0\u4E48\u573A\u666F\u9700\u8981\u8FD9\u79CD\u914D\u7F6E\u5462</strong>\uFF1F\u6211\u4EEC\u77E5\u9053<code>preset-env</code>\u662F\u652F\u6301<code>targets</code>\u914D\u7F6E\u7684\uFF0C\u4F46\u662F\u4E0D\u4E00\u5B9A\u975E\u5E38\u51C6\u786E\uFF0C\u6709\u65F6\u5019\u53EF\u80FD\u4F1A\u628A\u6211\u4EEC\u9700\u8981\u652F\u6301\u7684<code>\u8BED\u8A00\u7279\u6027</code>\u6392\u9664\u6389\u4E86\uFF0C\u6240\u4EE5\u8FD9\u65F6\u5019\u5C31\u9700\u8981<code>include</code>\uFF0C\u6765\u5355\u72EC\u6DFB\u52A0\u63D2\u4EF6\u6216<code>polyfill</code>\u3002\u540C\u6837\u7684<code>exclude</code>\u4F7F\u7528\u6765\u6392\u9664\uFF0C\u6D4F\u89C8\u5668\u652F\u6301\u7684\u8BED\u8A00\u7279\u6027\u3002</p><p>\u5728\u4E0B\u9762\u7684\u914D\u7F6E\u4E2D\uFF0C\u6211\u6DFB\u52A0\u4E86<code>targets</code>\u914D\u7F6E\uFF0C\u8BBE\u7F6E\u5F53\u524D\u73AF\u5883\u4E3A<code>chrome</code>\u6700\u65B0\u7684\u4E24\u4E2A\u7248\u672C\u3002\u90A3\u4E48\u5BF9\u4E8E\u4E0A\u9762\u7684\u4F8B\u5B50\u6765\u8BB2\uFF0C\u662F\u4E0D\u4F1A\u88AB polyfill \u7684\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;last 2 Chrome versions&quot;</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u7ED3\u679C\u5982\u6211\u4EEC\u9884\u671F\u90A3\u6837\uFF1A</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7e0a67c455104dab8909f3a68c98332e~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u8FD9\u65F6\u5019\u6211\u6DFB\u52A0\u4E00\u4E2A\u914D\u7F6E</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
        <span class="token string-property property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;last 2 Chrome versions&quot;</span>
        <span class="token punctuation">]</span><span class="token punctuation">,</span>
       <span class="token string-property property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token string">&quot;es.array.includes&quot;</span> <span class="token comment">// \u8FD9\u91CC\u6DFB\u52A0\u4E86\u914D\u7F6E</span>
       <span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u91CD\u65B0\u6253\u5305\u770B\u4E0B\uFF0C\u53D1\u73B0\u5DF2\u7ECF\u80FD\u6B63\u5E38\u7684 polyfill \u4E86</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/19b85793332a4f0783bcddbf66e4896c~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u5F53\u7136\uFF0C\u4F60\u4E5F\u53EF\u4EE5\u914D\u7F6E\u63D2\u4EF6\uFF0C\u4F8B\u5982\uFF1A\u4F60\u7684\u6D4F\u89C8\u5668\u5176\u5B9E\u4E0D\u652F\u6301<code>for of</code>\u8BED\u6CD5\uFF0C\u4F46\u88AB<code>targets</code>\u6392\u9664\u6389\u4E86\u3002\u8FD9\u79CD\u60C5\u51B5\u5C31\u53EF\u4EE5\u914D\u7F6E\u4E0A\u63D2\u4EF6\u540D\u3002</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;presets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token string-property property">&quot;useBuiltIns&quot;</span><span class="token operator">:</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;corejs&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;last 2 Chrome versions&quot;</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token string-property property">&quot;include&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// \u5728\u8FD9\u91CC\u914D\u7F6E</span>
        <span class="token string">&quot;@babel/plugin-transform-for-of&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">]</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4EE5\u4E0A\u5C31\u662F<code>include</code>\u7684\u4F5C\u7528\uFF0C<code>exclude</code>\u60F3\u5FC5\u4E0D\u7528\u591A\u8BF4\u4E86~</p><h3 id="\u53C2\u6570-3-targets" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570-3-targets" aria-hidden="true">#</a> \u53C2\u6570 3\uFF1Atargets</h3>`,45),h=n("code",null,"targets",-1),j={href:"https://www.jianshu.com/p/91157aa64244",target:"_blank",rel:"noopener noreferrer"},q=e(`<p><strong>\u6E90\u7801\uFF1A</strong></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u83B7\u53D6\u6240\u6709\u63D2\u4EF6\u5BF9\u5E94\u7684\u73AF\u5883</span>
<span class="token keyword">const</span> compatData <span class="token operator">=</span> <span class="token function">getPluginList</span><span class="token punctuation">(</span>shippedProposals<span class="token punctuation">,</span> bugfixes<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u5148\u770B\u4E0B<code>compatData</code>\u957F\u4EC0\u4E48\u6837\uFF1F</p><p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c609ddc00b2c492794f6e1200f7bec95~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u53EF\u4EE5\u53D1\u73B0<code>preset-env</code>\u4E2D\uFF0C\u5217\u51FA\u4E86\u6240\u6709\u63D2\u4EF6\u5BF9\u5E94\u7684\u6D4F\u89C8\u5668\u6700\u4F4E\u53EF\u4EE5\u652F\u6301\u7684\u7248\u672C\u3002\u5728\u540E\u9762\u5C06\u901A\u8FC7<code>targets</code>\u505A\u8FDB\u4E00\u6B65\u7684\u7B5B\u9009\u3002</p><p>\u5176\u5B9E<code>babel</code>\u5728<code>@babel/compat-data</code>\u4E2D\u7EF4\u62A4\u4E86\u4E00\u5957\u914D\u7F6E\u3002 \u6211\u4EEC\u5B9A\u4F4D\u5230\u8FD9\u4E2A\u76EE\u5F55</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>node_modules<span class="token operator">/</span>@babel<span class="token operator">/</span>compat<span class="token operator">-</span>data<span class="token operator">/</span>data<span class="token operator">/</span>plugins<span class="token punctuation">.</span>json
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/17651f65e1f9453a885f463e6230aafc~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u5728<code>core-js</code>\u4E2D\uFF0C\u4E5F\u540C\u6837\u7EF4\u62A4\u4E86\u4E00\u4EFD<code>polyfill</code>\u7684<code>targets</code>\u914D\u7F6E</p><p><code>node_modules/core-js-compat/data.json</code></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/b9c788da35204b3b980e90fa97bb7c4e~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><h3 id="\u53C2\u6570-4-modules" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570-4-modules" aria-hidden="true">#</a> \u53C2\u6570 4\uFF1Amodules</h3><p><strong>\u6E90\u7801</strong>\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> shouldSkipExportNamespaceFrom <span class="token operator">=</span>
  <span class="token punctuation">(</span>modules <span class="token operator">===</span> <span class="token string">&quot;auto&quot;</span> <span class="token operator">&amp;&amp;</span>
    <span class="token punctuation">(</span>api<span class="token punctuation">.</span>caller <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token keyword">void</span> <span class="token number">0</span> <span class="token operator">:</span> api<span class="token punctuation">.</span><span class="token function">caller</span><span class="token punctuation">(</span>supportsExportNamespaceFrom<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span>
  <span class="token punctuation">(</span>modules <span class="token operator">===</span> <span class="token boolean">false</span> <span class="token operator">&amp;&amp;</span>
    <span class="token operator">!</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _helperCompilationTargets<span class="token punctuation">.</span>isRequired<span class="token punctuation">)</span><span class="token punctuation">(</span>
      <span class="token string">&quot;proposal-export-namespace-from&quot;</span><span class="token punctuation">,</span>
      transformTargets<span class="token punctuation">,</span>
      <span class="token punctuation">{</span>
        compatData<span class="token punctuation">,</span>
        <span class="token literal-property property">includes</span><span class="token operator">:</span> include<span class="token punctuation">.</span>plugins<span class="token punctuation">,</span>
        <span class="token literal-property property">excludes</span><span class="token operator">:</span> exclude<span class="token punctuation">.</span>plugins<span class="token punctuation">,</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// modules\u5982\u679C\u662Fumd\u8FD9\u4E9B\u6A21\u5757\u89C4\u8303\uFF0C\u5C31\u4F1A\u52A0\u8F7D\u4E0B\u9762\u8FD9\u4E9B\u63D2\u4EF6</span>
<span class="token comment">// proposal-dynamic-import</span>
<span class="token comment">// proposal-export-namespace-from</span>
<span class="token comment">// syntax-top-level-await</span>

<span class="token comment">// modules: false</span>
<span class="token comment">// \u53EA\u652F\u6301\u8BED\u6CD5\uFF0C\u4E0D\u8FDB\u884C\u8F6C\u6362</span>
<span class="token comment">// syntax-dynamic-import</span>
<span class="token comment">// syntax-export-namespace-from</span>
<span class="token keyword">const</span> modulesPluginNames <span class="token operator">=</span> <span class="token function">getModulesPluginNames</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  modules<span class="token punctuation">,</span>
  <span class="token literal-property property">transformations</span><span class="token operator">:</span> _moduleTransformations<span class="token punctuation">.</span>default<span class="token punctuation">,</span>
  <span class="token literal-property property">shouldTransformESM</span><span class="token operator">:</span>
    modules <span class="token operator">!==</span> <span class="token string">&quot;auto&quot;</span> <span class="token operator">||</span>
    <span class="token operator">!</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>caller <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> api<span class="token punctuation">.</span><span class="token function">caller</span><span class="token punctuation">(</span>supportsStaticESM<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shouldTransformDynamicImport</span><span class="token operator">:</span>
    modules <span class="token operator">!==</span> <span class="token string">&quot;auto&quot;</span> <span class="token operator">||</span>
    <span class="token operator">!</span><span class="token punctuation">(</span>api<span class="token punctuation">.</span>caller <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> api<span class="token punctuation">.</span><span class="token function">caller</span><span class="token punctuation">(</span>supportsDynamicImport<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shouldTransformExportNamespaceFrom</span><span class="token operator">:</span> <span class="token operator">!</span>shouldSkipExportNamespaceFrom<span class="token punctuation">,</span>
  <span class="token literal-property property">shouldParseTopLevelAwait</span><span class="token operator">:</span> <span class="token operator">!</span>api<span class="token punctuation">.</span>caller <span class="token operator">||</span> api<span class="token punctuation">.</span><span class="token function">caller</span><span class="token punctuation">(</span>supportsTopLevelAwait<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5728\u4E0A\u9762\u7684\u4EE3\u7801\u4E2D\uFF0C\u6211\u4EEC\u53EF\u4EE5\u770B\u5230\uFF0C\u90FD\u6709\u4E00\u6BB5\u8FD9\u6837\u7684\u4EE3\u7801\uFF1A<code>api.caller</code></p><p>\u5B83\u7684\u4F5C\u7528\u662F\u4EC0\u4E48\u5462\uFF0C\u6211\u4EEC\u5148\u770B\u770B\u6587\u6863\uFF1A</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7a9138151b094f9796c30daafa01dbb9~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u610F\u601D\u5C31\u662F\uFF0C\u6211\u4EEC\u53EF\u4EE5\u544A\u8BC9<code>babel</code>\uFF0C\u6211\u4EEC\u5DF2\u7ECF\u652F\u6301\u4E86\u90E8\u5206\u8BED\u8A00\u7279\u6027\uFF0C\u4F8B\u5982<code>webpack</code>\u5B83\u81EA\u8EAB\u5DF2\u7ECF\u53EF\u4EE5\u8BC6\u522B<code>esm</code>, <code>\u52A8\u6001import</code>, <code>top-level-await</code>\u4E86\uFF0C\u5E76\u4E14\u8FD8\u81EA\u5DF1\u5B9E\u73B0\u4E86\u3002\u90A3\u4E48\u6211\u4EEC\u53EF\u4EE5\u544A\u8BC9<code>babel</code>, \u4F60\u4E0D\u9700\u8981\u81EA\u5DF1\u53BB\u7F16\u8BD1\u4E86~\u5269\u4E0B\u4EA4\u7ED9\u6211\u3002\u3002</p><p>\u6240\u4EE5\u6211\u4EEC\u80FD\u6253\u5F00<code>babel-loader</code>, \u770B\u4E0B\u5B83\u7684\u914D\u7F6E</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/3187479e3452458b839ea7edb762149e~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u544A\u8BC9<code>babel</code>\u4EE5\u4E0A\u7684\u8BED\u6CD5\u90FD\u662F\u652F\u6301\u7684\u3002</p><p>\u8FD9\u6837\uFF0C\u5728\u4E0B\u9762\u7684\u6E90\u7801\u91CC\uFF0C\u5C31\u53EF\u4EE5\u505A\u5230\u6309\u9700\u6DFB\u52A0\u6A21\u5757\u8F6C\u6362\u63D2\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> getModulesPluginNames <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  modules<span class="token punctuation">,</span>
  transformations<span class="token punctuation">,</span>
  shouldTransformESM<span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u8F6C\u6362esm</span>
  shouldTransformDynamicImport<span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u8F6C\u6362\u52A8\u6001import</span>
  shouldTransformExportNamespaceFrom<span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u8F6C\u6362\u547D\u540D\u5BFC\u51FA export * as ns from &quot;mod&quot;;</span>
  shouldParseTopLevelAwait<span class="token punctuation">,</span> <span class="token comment">// \u662F\u5426\u7F16\u8BD1toplevel await</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> modulesPluginNames <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>modules <span class="token operator">!==</span> <span class="token boolean">false</span> <span class="token operator">&amp;&amp;</span> transformations<span class="token punctuation">[</span>modules<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldTransformESM<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      modulesPluginNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>transformations<span class="token punctuation">[</span>modules<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>
      shouldTransformDynamicImport <span class="token operator">&amp;&amp;</span>
      shouldTransformESM <span class="token operator">&amp;&amp;</span>
      modules <span class="token operator">!==</span> <span class="token string">&quot;umd&quot;</span>
    <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      modulesPluginNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;proposal-dynamic-import&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldTransformDynamicImport<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span>
          <span class="token string">&quot;Dynamic import can only be supported when transforming ES modules&quot;</span> <span class="token operator">+</span>
            <span class="token string">&quot; to AMD, CommonJS or SystemJS. Only the parser plugin will be enabled.&quot;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

      modulesPluginNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;syntax-dynamic-import&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    modulesPluginNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;syntax-dynamic-import&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldTransformExportNamespaceFrom<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    modulesPluginNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;proposal-export-namespace-from&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    modulesPluginNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;syntax-export-namespace-from&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>shouldParseTopLevelAwait<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    modulesPluginNames<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;syntax-top-level-await&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> modulesPluginNames<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u53E6\u5916\uFF0C\u8FD8\u4F1A\u6839\u636E\u4F60\u7684<code>modules</code>\u914D\u7F6E\uFF0C\u53BB\u6DFB\u52A0\u5BF9\u5E94\u7684\u6A21\u5757\u8F6C\u6362\u63D2\u4EF6, \u53EF\u4EE5\u770B\u5230\u9ED8\u8BA4\u662F<code>auto</code>,\u4F7F\u7528\u4E86<code>commonjs</code>\u6A21\u5757\u8F6C\u6362\u63D2\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  <span class="token literal-property property">auto</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-commonjs&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">amd</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-amd&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">commonjs</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-commonjs&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cjs</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-commonjs&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">systemjs</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-systemjs&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">umd</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-umd&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u603B\u7ED3\u4E00\u4E0B\uFF1A</strong></p><ol><li><p>\u83B7\u53D6\u5F53\u524D\u73AF\u5883\u662F\u5426\u652F\u6301\u547D\u540D\u7A7A\u95F4\u5BFC\u51FA\uFF0C\u4F8B\u5982<code>export * as xxx from &#39;xxx&#39;</code></p></li><li><p>\u83B7\u53D6\u5BF9\u5E94\u7684\u6A21\u5757\u63D2\u4EF6\uFF0C\u5982\u679C\u8FD8\u652F\u6301<code>top-level-await</code>\u5C31\u8FD4\u56DE<code>syntax-top-level-await</code>, \u5982\u679C\u6709\u52A8\u6001 import, \u5C31\u8FD4\u56DE<code>syntax-dynamic-import</code>\uFF08\u5176\u4E2D\u6709\u4E00\u4E9B\u7EC6\u8282\uFF0C\u4E0D\u8BE6\u7EC6\u5C55\u5F00\u4E86\uFF09</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// node_modules/@babel/preset-env/lib/module-transformations.js</span>
<span class="token punctuation">{</span>
  <span class="token literal-property property">auto</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-commonjs&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">amd</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-amd&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">commonjs</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-commonjs&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">cjs</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-commonjs&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">systemjs</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-systemjs&quot;</span><span class="token punctuation">,</span>
  <span class="token literal-property property">umd</span><span class="token operator">:</span> <span class="token string">&quot;transform-modules-umd&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u5982\u679C\u914D\u7F6E<code>modules: false</code>\uFF0C\u5176\u5B9E\u4E0D\u9700\u8981\u505A\u8F6C\u6362\u4E86\uFF0C\u53EA\u9700\u8981\u652F\u6301\u8BED\u6CD5 \uFF0C\u4EE5\u4E0B\u662F\u914D\u7F6E<code>modules: false</code>\u4E4B\u540E\u6240\u9700\u7684\u63D2\u4EF6\u3002</p><p><img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/185be6399c004da08455eda428da4a31~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p></li></ol><p>\u7531\u4E8E<code>modules</code>\u9ED8\u8BA4\u503C\u4E3A<code>auto</code>, \u6240\u4EE5\u9ED8\u8BA4\u7684\u6A21\u5757\u89C4\u8303\u5C31\u662F<code>commonjs</code>, \u8FDB\u800C\u4F7F\u7528<code>@babel/transform-modules-commonjs</code>\u8FDB\u884C\u8F6C\u6362\u3002</p><p>\u5176\u4ED6\u914D\u7F6E\u540C\u7406~</p><h3 id="\u53C2\u6570-5-usebuiltins" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570-5-usebuiltins" aria-hidden="true">#</a> \u53C2\u6570 5\uFF1AuseBuiltIns</h3><blockquote><p>\u8BE5\u914D\u7F6E\u5FC5\u987B\u548C<code>corejs</code>\u642D\u914D\u4F7F\u7528</p></blockquote><p><strong>\u6E90\u7801</strong>\uFF1A</p><p>\u524D\u9762\u8BF4\u5230<code>babel</code>\u7EF4\u62A4\u4E86\u4E00\u5957<code>compactData</code>\u914D\u7F6E\u3002</p><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/17651f65e1f9453a885f463e6230aafc~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u4E0B\u9762\u5C31\u4F1A\u6839\u636E\u73AF\u5883\u914D\u7F6E\uFF0C\u7B5B\u9009\u51FA\u9700\u8981\u7684\u63D2\u4EF6</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u6839\u636E\u76EE\u6807\u73AF\u5883 \u7B5B\u9009\u51FA\u9700\u8981\u7684\u63D2\u4EF6</span>
<span class="token keyword">const</span> pluginNames <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _helperCompilationTargets<span class="token punctuation">.</span>filterItems<span class="token punctuation">)</span><span class="token punctuation">(</span>
  compatData<span class="token punctuation">,</span>
  include<span class="token punctuation">.</span>plugins<span class="token punctuation">,</span>
  exclude<span class="token punctuation">.</span>plugins<span class="token punctuation">,</span>
  transformTargets<span class="token punctuation">,</span>
  modulesPluginNames<span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _getOptionSpecificExcludes<span class="token punctuation">.</span>default<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    loose<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  _shippedProposals<span class="token punctuation">.</span>pluginSyntaxMap
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c1ae9903546241b8b475ed337288f670~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u83B7\u53D6\u5230\u9700\u8981\u7684\u63D2\u4EF6\u540E\uFF0C\u5C31\u5230\u8FBE\u5F88\u5173\u952E\u7684\u5730\u65B9\u4E86\uFF0C \u6211\u4EEC\u770B\u4E0B<code>polyfill</code>\u662F\u5982\u4F55\u6DFB\u52A0\u7684</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// \u83B7\u53D6polyfill\u63D2\u4EF6</span>
<span class="token keyword">const</span> polyfillPlugins <span class="token operator">=</span> <span class="token function">getPolyfillPlugins</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  useBuiltIns<span class="token punctuation">,</span>
  corejs<span class="token punctuation">,</span>
  <span class="token literal-property property">polyfillTargets</span><span class="token operator">:</span> targets<span class="token punctuation">,</span>
  <span class="token literal-property property">include</span><span class="token operator">:</span> include<span class="token punctuation">.</span>builtIns<span class="token punctuation">,</span>
  <span class="token literal-property property">exclude</span><span class="token operator">:</span> exclude<span class="token punctuation">.</span>builtIns<span class="token punctuation">,</span>
  proposals<span class="token punctuation">,</span>
  shippedProposals<span class="token punctuation">,</span>
  <span class="token literal-property property">regenerator</span><span class="token operator">:</span> pluginNames<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token string">&quot;transform-regenerator&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  debug<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">getPolyfillPlugins</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span>
  useBuiltIns<span class="token punctuation">,</span>
  corejs<span class="token punctuation">,</span>
  polyfillTargets<span class="token punctuation">,</span>
  include<span class="token punctuation">,</span>
  exclude<span class="token punctuation">,</span>
  proposals<span class="token punctuation">,</span>
  shippedProposals<span class="token punctuation">,</span>
  regenerator<span class="token punctuation">,</span>
  debug<span class="token punctuation">,</span>
<span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> polyfillPlugins <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>useBuiltIns <span class="token operator">===</span> <span class="token string">&quot;usage&quot;</span> <span class="token operator">||</span> useBuiltIns <span class="token operator">===</span> <span class="token string">&quot;entry&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> pluginOptions <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>useBuiltIns<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-global</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">,</span>
      <span class="token literal-property property">version</span><span class="token operator">:</span> corejs <span class="token operator">?</span> corejs<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">,</span>
      <span class="token literal-property property">targets</span><span class="token operator">:</span> polyfillTargets<span class="token punctuation">,</span>
      include<span class="token punctuation">,</span>
      exclude<span class="token punctuation">,</span>
      proposals<span class="token punctuation">,</span>
      shippedProposals<span class="token punctuation">,</span>
      debug<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token comment">// \u5224\u65AD\u662F\u5426\u914D\u7F6Ecorejs</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>corejs<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>useBuiltIns <span class="token operator">===</span> <span class="token string">&quot;usage&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>corejs<span class="token punctuation">.</span>major <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// \u6DFB\u52A0 babel-plugin-polyfill-corejs2 \u548C babel-polyfill \u63D2\u4EF6</span>
          polyfillPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span>pluginCoreJS2<span class="token punctuation">,</span> pluginOptions<span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
              _babelPolyfill<span class="token punctuation">.</span>default<span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token literal-property property">usage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// \u6DFB\u52A0 babel-plugin-polyfill-corejs3 \u63D2\u4EF6 \u548C babel-polyfill \u63D2\u4EF6</span>
          polyfillPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span>pluginCoreJS3<span class="token punctuation">,</span> pluginOptions<span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
              _babelPolyfill<span class="token punctuation">.</span>default<span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token literal-property property">usage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
                <span class="token literal-property property">deprecated</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// \u6DFB\u52A0 babel-plugin-polyfill-regenerator \u63D2\u4EF6</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>regenerator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          polyfillPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
            pluginRegenerator<span class="token punctuation">,</span>
            <span class="token punctuation">{</span>
              <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">&quot;usage-global&quot;</span><span class="token punctuation">,</span>
              debug<span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
          <span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>corejs<span class="token punctuation">.</span>major <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// babel-polyfill \u63D2\u4EF6\uFF08\u5168\u5C40\u5F15\u5165\uFF09\u3001babel-plugin-polyfill-corejs2\u63D2\u4EF6</span>
          <span class="token comment">// \u6CE8\u610F\u63D2\u4EF6\u6267\u884C\u987A\u5E8F\uFF0C\u5148\u6267\u884C\u7684babel-polyfill</span>
          polyfillPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span>
              _babelPolyfill<span class="token punctuation">.</span>default<span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                regenerator<span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>pluginCoreJS2<span class="token punctuation">,</span> pluginOptions<span class="token punctuation">]</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          <span class="token comment">// \u6DFB\u52A0 babel-plugin-polyfill-corejs3 \u63D2\u4EF6 \u548C babel-polyfill \u63D2\u4EF6</span>
          polyfillPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
            <span class="token punctuation">[</span>pluginCoreJS3<span class="token punctuation">,</span> pluginOptions<span class="token punctuation">]</span><span class="token punctuation">,</span>
            <span class="token punctuation">[</span>
              _babelPolyfill<span class="token punctuation">.</span>default<span class="token punctuation">,</span>
              <span class="token punctuation">{</span>
                <span class="token literal-property property">deprecated</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token punctuation">]</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>

          <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>regenerator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            polyfillPlugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>_regenerator<span class="token punctuation">.</span>default<span class="token punctuation">,</span> pluginOptions<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">return</span> polyfillPlugins<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u6211\u4EEC\u53EF\u4EE5\u603B\u7ED3\u5982\u4E0B\u51E0\u70B9</p><ul><li><p>\u5B58\u5728 corejs \u914D\u7F6E</p><ul><li><p><strong>useBuiltIns: usage</strong></p><ul><li><p>\u5982\u679C\u914D\u7F6E core-js@3</p><ul><li>\u6DFB\u52A0 babel-plugin-polyfill-corejs3 \u63D2\u4EF6</li><li>\u6DFB\u52A0 babel-polyfill \u63D2\u4EF6 (@babel/preset-env/lib/polyfills/babel-polyfill.js)</li></ul></li><li><p>\u5982\u679C\u914D\u7F6E core-js@2</p><ul><li>\u6DFB\u52A0 babel-plugin-polyfill-corejs2 \u63D2\u4EF6</li><li>\u6DFB\u52A0 babel-polyfill \u63D2\u4EF6 (@babel/preset-env/lib/polyfills/babel-polyfill.js)</li></ul></li><li><p>\u5982\u679C\u914D\u7F6E transform-regenerator</p><ul><li>\u6DFB\u52A0 babel-plugin-polyfill-regenerator \u63D2\u4EF6</li></ul></li></ul></li><li><p><strong>useBuiltIns: entry | false</strong></p><ul><li><p>\u5982\u679C\u914D\u7F6E core-js@3</p><ul><li>\u6DFB\u52A0 babel-plugin-polyfill-corejs3 \u63D2\u4EF6</li><li>\u6DFB\u52A0 babel-polyfill \u63D2\u4EF6 (@babel/preset-env/lib/polyfills/babel-polyfill.js)</li></ul></li><li><p>\u5982\u679C\u914D\u7F6E core-js@2</p><ul><li>\u6DFB\u52A0 babel-plugin-polyfill-corejs2</li><li>\u6DFB\u52A0 babel-polyfill \u63D2\u4EF6 (@babel/preset-env/lib/polyfills/babel-polyfill.js)</li></ul></li><li><p>\u5982\u679C\u6CA1\u6709\u914D\u7F6E transform-regenerator \u63D2\u4EF6</p><ul><li>\u6DFB\u52A0 regenerator \u63D2\u4EF6\u5220\u9664 regenerator \u5BFC\u5165\uFF08@babel/preset-env/lib/polyfills/regenerator.js\uFF09</li></ul></li></ul></li></ul></li></ul><p><strong>\u4F7F\u7528</strong>:</p><p>\u597D\u7684\uFF0C\u4E0A\u9762\u5C31\u662F<code>polyfill</code>\u63D2\u4EF6\u7684\u5177\u4F53\u6DFB\u52A0\u8FC7\u7A0B\uFF0C\u4E0B\u9762\u6211\u4EEC\u6765\u770B\u770B<code>useBuiltIns</code>\u662F\u5982\u4F55\u4F7F\u7528\u7684\u3002</p><ul><li><p>\u5728<code>useBuiltIns: &quot;usage&quot;</code>\u7684\u914D\u7F6E\u4E0B\uFF0C\u6253\u5305\u7ED3\u679C\u5982\u4E0B <img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/c6ca9f9d0f6745f88b91d74a3ca681e0~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"> \u53EF\u4EE5\u770B\u5230\u80FD\u591F\u5B9E\u73B0\u6309\u9700\u5F15\u5165</p></li><li><p>\u5728<code>useBuiltIns: &quot;entry&quot;</code>\u7684\u914D\u7F6E\u4E0B\uFF0C\u8FD8\u9700\u8981\u5728\u5165\u53E3\u6587\u4EF6\u4E2D\u6DFB\u52A0<code>core-js</code>\u7684\u5BFC\u5165\uFF0C\u5982\u4F55\u4F60\u8FD8\u60F3\u652F\u6301<code>async</code>\u8BED\u6CD5\uFF0C\u8FD8\u9700\u8981\u5F15\u5165<code>regenerator-runtime/runtime.js</code></p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token string">&quot;core-js&quot;</span><span class="token punctuation">;</span> <span class="token comment">// \u5176\u4ED6\u8BED\u8A00\u7279\u6027\u652F\u6301</span>
<span class="token keyword">import</span> <span class="token string">&quot;regenerator-runtime/runtime.js&quot;</span><span class="token punctuation">;</span> <span class="token comment">// \u652F\u6301async</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">&quot;1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/abede275b27c447682ca4b0ec538bff6~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><p>\u53EF\u4EE5\u770B\u5230\uFF0C\u4F1A\u628A\u6240\u6709\u7684 polyfill \u90FD\u5F15\u5165\u8FDB\u6765\uFF0C\u6240\u4EE5<code>entry</code>\u7684\u914D\u7F6E\u5E76\u4E0D\u63A8\u8350\u4F7F\u7528\uFF0C\u4F1A<code>\u5168\u91CF\u5F15\u5165</code>\u3002</p></li><li><p>\u5728<code>useBuiltIns: false</code>\u914D\u7F6E\u4E0B\uFF0C<code>core-js</code>\u914D\u7F6E\u5C06\u5931\u6548\uFF0C\u4E0D\u4F1A\u5E2E\u52A9\u5F15\u5165<code>polyfill</code></p></li></ul><h3 id="\u53C2\u6570-6-corejs" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570-6-corejs" aria-hidden="true">#</a> \u53C2\u6570 6\uFF1Acorejs</h3><p>corejs \u5C31\u6BD4\u8F83\u7B80\u5355\u4E86\uFF0C\u6307\u5B9A corejs \u7684\u7248\u672C\u5C31\u53EF\u4EE5\u4E86\uFF0C\u4F46\u662F\u5FC5\u987B\u642D\u914D<code>useBuiltIns</code>\u4F7F\u7528\u54E6~</p><h3 id="\u53C2\u6570-7-debug" tabindex="-1"><a class="header-anchor" href="#\u53C2\u6570-7-debug" aria-hidden="true">#</a> \u53C2\u6570 7\uFF1Adebug</h3><p><strong>\u6E90\u7801</strong>\uFF1A</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>debug<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;@babel/preset-env: \`DEBUG\` option&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;\\nUsing targets:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
    <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>
      <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _helperCompilationTargets<span class="token punctuation">.</span>prettifyTargets<span class="token punctuation">)</span><span class="token punctuation">(</span>targets<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token keyword">null</span><span class="token punctuation">,</span>
      <span class="token number">2</span>
    <span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">\\nUsing modules transform: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>modules<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;\\nUsing plugins:&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  pluginNames<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">pluginName</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> _debug<span class="token punctuation">.</span>logPlugin<span class="token punctuation">)</span><span class="token punctuation">(</span>pluginName<span class="token punctuation">,</span> targets<span class="token punctuation">,</span> compatData<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>useBuiltIns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>
      <span class="token string">&quot;\\nUsing polyfills: No polyfills were added, since the \`useBuiltIns\` option was not set.&quot;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>\u4F7F\u7528</strong>:</p><p>\u5F53\u914D\u7F6E\u4E0A<code>debug: true</code>\u540E\uFF0C\u63A7\u5236\u53F0\u5C31\u80FD\u770B\u89C1\u4F60\u4F7F\u7528\u4E86\u54EA\u4E9B\u63D2\u4EF6</p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/1f4629fc62fc4703a7955e6884aba690~tplv-k3u1fbpfcp-watermark.image?" alt="image.png" loading="lazy"></p><h2 id="\u56DB\u3001babel-plugin-polyfill-corejs3" tabindex="-1"><a class="header-anchor" href="#\u56DB\u3001babel-plugin-polyfill-corejs3" aria-hidden="true">#</a> \u56DB\u3001babel-plugin-polyfill-corejs3</h2>`,54),x={href:"https://juejin.cn/post/7112770927082864653",target:"_blank",rel:"noopener noreferrer"},_=n("p",null,"helper-define-polyfill-provider",-1);function w(P,T){const a=c("ExternalLinkIcon");return o(),l("div",null,[u,r,d,k,n("ul",null,[n("li",null,[n("p",null,[n("a",v,[s("\u5E26\u4F60\u73A9\u8F6C\u5DE5\u5177\u94FE\uFF08\u4E00\uFF09@babel/parser"),p(a)])])]),n("li",null,[n("p",null,[n("a",m,[s("\u5E26\u4F60\u73A9\u8F6C babel \u5DE5\u5177\u94FE\uFF08\u4E8C\uFF09@babel/traverse"),p(a)])])]),n("li",null,[n("p",null,[n("a",b,[s("\u5E26\u4F60\u73A9\u8F6C babel \u5DE5\u5177\u94FE\uFF08\u4E09\uFF09@babel/generator"),p(a)])])]),n("li",null,[n("p",null,[n("a",g,[s("\u5E26\u4F60\u73A9\u8F6C babel \u5DE5\u5177\u94FE\uFF08\u56DB\uFF09babel \u63D2\u4EF6\u548C preset"),p(a)])])]),n("li",null,[n("p",null,[n("a",f,[s("\u5E26\u4F60\u73A9\u8F6C babel \u5DE5\u5177\u94FE\uFF08\u4E94\uFF09\u5F7B\u5E95\u7406\u89E3@babel/helpers \u4E0E @babel/runtime"),p(a)])])])]),y,n("p",null,[h,s("\u7684\u5199\u6CD5\u5927\u5BB6\u53EF\u4EE5\u53C2\u8003\u8FD9\u7BC7\u6587\u7AE0"),n("a",j,[s("Browser list \u8BE6\u89E3"),p(a)])]),q,n("p",null,[s("\u6211\u6B63\u5728\u53C2\u4E0E\u6398\u91D1\u6280\u672F\u793E\u533A\u521B\u4F5C\u8005\u7B7E\u7EA6\u8BA1\u5212\u62DB\u52DF\u6D3B\u52A8\uFF0C"),n("a",x,[s("\u70B9\u51FB\u94FE\u63A5\u62A5\u540D\u6295\u7A3F"),p(a)])]),_])}const B=t(i,[["render",w],["__file","6. \u5E26\u4F60\u73A9\u8F6Cbabel\u5DE5\u5177\u94FE\uFF08\u516D\uFF09\u662F\u65F6\u5019\u6765\u770B\u770Bpreset-env\u7684\u6E90\u7801\u4E86.html.vue"]]);export{B as default};
