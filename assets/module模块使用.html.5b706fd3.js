import{_ as l}from"./plugin-vueexport-helper.2444895f.js";import{o as d,c,e as a,a as e,b as s,d as o,r as i}from"./app.c4c36fb7.js";const t={},p=e("h1",{id:"module-\u6A21\u5757\u4F7F\u7528",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#module-\u6A21\u5757\u4F7F\u7528","aria-hidden":"true"},"#"),s(" module \u6A21\u5757\u4F7F\u7528")],-1),r=e("h2",{id:"resolvefilename",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#resolvefilename","aria-hidden":"true"},"#"),s(" _resolveFilename")],-1),u=e("p",null,[e("strong",null,"\u4F5C\u7528\uFF1A\u89E3\u6790\u6A21\u5757\u7684\u771F\u5B9E\u8DEF\u5F84\uFF0C\u4F8B\u5982\u76F8\u5BF9\u8DEF\u5F84\u89E3\u6790\u4E3A\u7EDD\u5BF9\u8DEF\u5F84\u3002")],-1),m=o(`<div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> parent <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> fromFile<span class="token punctuation">,</span> <span class="token comment">// \u6587\u4EF6\u8DEF\u5F84</span>
  <span class="token literal-property property">filename</span><span class="token operator">:</span> fromFile<span class="token punctuation">,</span> <span class="token comment">// \u6587\u4EF6\u8DEF\u5F84</span>
  <span class="token literal-property property">paths</span><span class="token operator">:</span> Module<span class="token punctuation">.</span><span class="token function">_nodeModulePaths</span><span class="token punctuation">(</span>fromDir<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// \u83B7\u53D6\u6240\u6709node_modules\u53EF\u80FD\u7684\u4F4D\u7F6E</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// \u7B2C\u4E8C\u4E2A\u53C2\u6570\u5B9E\u9645\u4E0A\u662F\u7236\u6A21\u5757\u5BF9\u8C61</span>
Module<span class="token punctuation">.</span><span class="token function">_resolveFilename</span><span class="token punctuation">(</span>moduleId<span class="token punctuation">,</span> parent<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="nodemodulepaths" tabindex="-1"><a class="header-anchor" href="#nodemodulepaths" aria-hidden="true">#</a> _nodeModulePaths</h2><p>\u4F5C\u7528\uFF1A\u751F\u6210 node_modules \u53EF\u80FD\u7684\u8DEF\u5F84\uFF0C\u4F8B\u5982</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>Module<span class="token punctuation">.</span><span class="token function">_nodeModulePaths</span><span class="token punctuation">(</span>fromDir<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// fromDir: /home/yuangong/tmp</span>

<span class="token comment">// [ &#39;/home/yuangong/tmp/node_modules&#39;,</span>
<span class="token comment">// &#39;/home/yuangong/node_modules&#39;,</span>
<span class="token comment">// &#39;/home/node_modules&#39;,</span>
<span class="token comment">// &#39;/node_modules&#39; ]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="findpath" tabindex="-1"><a class="header-anchor" href="#findpath" aria-hidden="true">#</a> _findPath</h2>`,5),h=o('<h2 id="node-\u6A21\u5757\u89E3\u6790\u6D41\u7A0B" tabindex="-1"><a class="header-anchor" href="#node-\u6A21\u5757\u89E3\u6790\u6D41\u7A0B" aria-hidden="true">#</a> Node \u6A21\u5757\u89E3\u6790\u6D41\u7A0B</h2><ul><li><p>Nodejs \u9879\u76EE\u6A21\u5757\u8DEF\u5F84\u89E3\u6790\u662F\u901A\u8FC7<code>require.resolve</code>\u65B9\u6CD5\u6765\u5B9E\u73B0\u7684</p></li><li><p><code>require.resolve</code>\u5C31\u662F\u901A\u8FC7<code>Module.resolveFileName</code> \u65B9\u6CD5\u5B9E\u73B0\u7684</p></li><li><p><code>require.resolve</code>\u5B9E\u73B0\u539F\u7406:</p><ul><li><p><code>Module.resolveFileName</code>\u65B9\u6CD5\u6838\u5FC3\u6D41\u7A0B\u6709 3 \u70B9:</p><ul><li>\u5224\u65AD\u662F\u5426\u4E3A\u5185\u7F6E\u6A21\u5757</li><li>\u901A\u8FC7<code>ModuleresolveLookupPaths</code>\u65B9\u6CD5\u751F\u6210<code>node_modules</code>\u53EF\u80FD\u5B58\u5728\u7684\u8DEF\u5F84</li><li>\u901A\u8FC7<code>Module.findPath</code>\u67E5\u8BE2\u6A21\u5757\u7684\u771F\u5B9E\u8DEF\u5F84</li></ul></li><li><p><code>Module.findPath</code>\u6838\u5FC3\u6D41\u7A0B\u6709 4 \u70B9:</p><ul><li>\u67E5\u8BE2\u7F13\u5B58(\u5C06<code>request\u548Cpaths</code>\u901A\u8FC7<code>\\x00</code>\u5408\u5E76\u6210 cacheKey)</li><li>\u904D\u5386 paths \u5C06<code>path\u4E0Erequest</code>\u7EC4\u6210\u6587\u4EF6\u8DEF\u5F84<code>basePath</code></li><li>\u5982\u679C<code>basePath</code>\u5B58\u5728\u5219\u8C03\u7528<code>fs.realPathSync</code>\u83B7\u53D6\u6587\u4EF6\u771F\u5B9E\u8DEF\u5F84</li><li>\u5C06\u6587\u4EF6\u771F\u5B9E\u8DEF\u5F84\u7F13\u5B58\u5230<code>Module.pathCache</code>(key \u5C31\u662F\u524D\u9762\u751F\u6210\u7684 cacheKey)\u3002</li></ul></li><li><p><code>fs.realPathSync</code>\u6838\u5FC3\u6D41\u7A0B\u6709 3 \u70B9:</p><ul><li>\u67E5\u8BE2\u7F13\u5B58(\u7F13\u5B58\u7684 key \u4E3A p \u5373<code>Module.findPath</code>\u4E2D\u751F\u6210\u7684\u6587\u4EF6\u8DEF\u5F84) \u66F4\u591A\u8BFE\u7A0B\u8857</li><li>\u4ECE\u5DE6\u5F80\u53F3\u904D\u5386\u8DEF\u5F84\u5B57\u7B26\u4E32\uFF0C\u67E5\u8BE2\u5230<code>/</code>\u65F6\uFF0C\u62C6\u5206\u8DEF\u5F84\uFF0C\u5224\u65AD\u8BE5\u8DEF\u5F84\u662F\u5426\u4E3A\u8F6F\u94FE\u63A5\uFF0C\u5982\u679C\u662F\u8F6F\u94FE\u63A5\u5219\u67E5\u8BE2\u771F\u5B9E\u94FE\u63A5\uFF0C\u5E76\u751F\u6210\u65B0\u8DEF\u5F84 p \u7136\u540E\u7EE7\u7EED\u5F80\u540E\u904D\u5386\uFF0C\u8FD9\u91CC\u6709 1 \u4E2A\u7EC6\u8282\u9700\u8981\u7279\u522B\u6CE8\u610F: <ul><li>\u904D\u5386\u8FC7\u7A0B\u4E2D\u751F\u6210\u7684\u5B50\u8DEF\u5F84 base \u4F1A\u7F13\u5B58\u5728 knownHard \u548C cache \u4E2D\uFF0C\u907F\u514D\u91CD\u590D\u67E5\u8BE2</li></ul></li><li>\u904D\u5386\u5B8C\u6210\u5F97\u5230\u6A21\u5757\u5BF9\u5E94\u7684\u771F\u5B9E\u8DEF\u5F84\uFF0C\u6B64\u65F6\u4F1A\u5C06\u539F\u59CB\u8DEF\u8DEF\u5F84 original \u4F5C\u4E3A key\uFF0C\u771F\u5B9E\u8DEF\u5F84\u4F5C\u4E3A value\uFF0C\u4FDD\u5B58\u5230\u7F13\u5B58\u4E2D</li></ul></li></ul></li><li><p><code>require.resolve.paths</code>\u7B49\u4EF7\u4E8E<code>Module.resolveLookupPaths</code>\uFF0C\u8BE5\u65B9\u6CD5\u7528\u4E8E\u83B7\u53D6\u6240\u6709<code>node_modules</code></p><ul><li>\u5982\u679C\u8DEF\u5F84\u4E3A/(\u6839\u76EE\u5F55)\uFF0C\u76F4\u63A5\u8FD4\u56DE<code>[&#39;/node_modules&#39;]</code></li><li>\u5426\u5219\uFF0C\u5C06\u8DEF\u5F84\u5B57\u7B26\u4E32\u4ECE\u540E\u5F80\u524D\u904D\u5386\uFF0C\u67E5\u8BE2\u5230/\u65F6\uFF0C\u62C6\u5206\u8DEF\u5F84\uFF0C\u5728\u540E\u9762\u52A0\u4E0A<code>node_modules</code>\uFF0C\u5E76\u4F20\u5165\u4E00\u4E2A<code>paths</code>\u6570\u7EC4\uFF0C\u76F4\u81F3\u67E5\u8BE2\u4E0D\u5230<code>/</code>\u540E\u8FD4\u56DE<code>paths</code>\u6570\u7EC4</li></ul></li></ul>',2);function v(k,f){const n=i("Mermaid");return d(),c("div",null,[p,r,u,a(n,{id:"mermaid-9",code:"eNpLy8kvT85ILCpRCHGy5lJQSNTwzU8pzUnViy9KLc7PKUt1y8xJzUvMTdVU0NW1U0iqfjZj/dMJy57s2PW0rfX53nXPVix8Ond6LVBnElhBDVCyJgXdEJ/8/OzSgoDEkoxiHYWnG9oKQKynk3qe961/uqj5af+Ml+39efkpqfG5YH3FTyd0PN25TRNhKtDWmmQN17wUkFgKWCwNbklaZl4KyGydp3NWgE1+smPti+WLn82bAHHd81ktz+fMf7pu3ovt65/uawEZkQY2IpkLAIqyctE="}),m,a(n,{id:"mermaid-21",code:"eNpLy8kvT85ILCpRCHGy5lJQSNTwzU8pzUnVi0/LzEsJSCzJ0FTQ1bVTSKp+Nn/pi/WLnu+Z/HTtjFqgyiSweM2zGetrkjWez97yrG/pi/1Tns6e93z35Gfz5mgClSSDlaRouOalgLhQHU8nLKtJ1XjZ2Pu0r60AaEGxztMJHU93bgOxn07qKUotLE0tLgFpSAVrSKt+Nq39ye5tQJuAWoG2P52zAuSANCTjEFyQe9I1Xmxofj5lRUl+UGpiDsgTz6fMf9Yx4fmc+U/XzXuxff3TfS0g89PBWjKqISLo5mcgDExBcCHWAQBLcoxz"}),h])}const b=l(t,[["render",v],["__file","module\u6A21\u5757\u4F7F\u7528.html.vue"]]);export{b as default};
